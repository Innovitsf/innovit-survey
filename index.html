<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>INNOVIT – Alumni Progress</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root { --accent:#2A6252; --muted:#6b7280; --ok:#16a34a; --warn:#b45309; --bg:#f8fafc; }

    body{
      font-family:system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background:var(--bg);
      margin:0;
    }

    .container{
      /* GLOBAL: full-screen layout */
      width:100%;
      max-width:none;
      margin:0;
      padding:24px 32px 40px;
      box-sizing:border-box;
    }

    /* Brand header with INNOVIT logo */
    .brand-header{
      max-width:1200px;
      margin:0 auto 16px;
      padding:16px 24px;
      background:var(--accent);
      border-radius:16px;
      display:flex;
      align-items:center;
      justify-content:flex-start;
    }
    .brand-logo{
      height:48px;
      width:auto;
      display:block;
    }

    h1{
      margin:16px auto 6px;
      font-size:28px;
      color:#111827;
      max-width:1200px;
    }
    .sub{
      color:var(--muted);
      margin:0 auto 18px;
      max-width:1200px;
    }

    .card{
      background:#fff;
      border-radius:16px;
      padding:24px 24px 28px;
      box-shadow:0 8px 24px rgba(0,0,0,.06);
      position:relative;
      max-width:1200px;
      margin:0 auto;
    }

    .bar{
      height:10px;
      background:#e5e7eb;
      border-radius:999px;
      overflow:hidden;
      margin:12px 0 20px;
    }
    .bar>div{
      height:100%;
      width:0%;
      background:var(--accent);
      transition:width .3s;
    }

    .steps{
      display:flex;
      gap:8px;
      margin-bottom:8px;
      font-size:13px;
      color:var(--muted);
      align-items:center;
    }
    .steps .dot{
      width:22px;
      height:22px;
      border-radius:999px;
      border:2px solid #e5e7eb;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .steps .dot.active{
      border-color:var(--accent);
      background:var(--accent);
      color:#fff;
    }
    .steps span.label{
      font-weight:500;
      color:#111827;
    }
    .steps span.sep{
      flex:1;
      height:1px;
      background:#e5e7eb;
      margin:0 4px;
      border-radius:999px;
    }

    .step{display:none;}
    .step.active{display:block;}

    .grid{
      display:grid;
      grid-template-columns:1.5fr 1.5fr;
      gap:18px 24px;
    }
    .grid-1{
      display:grid;
      grid-template-columns:1fr;
      gap:18px;
    }

    label{
      display:block;
      font-size:14px;
      font-weight:500;
      color:#111827;
      margin-bottom:4px;
    }
    .req{color:#b91c1c; margin-left:3px;}

    input, select, textarea{
      font-family:inherit;
      font-size:14px;
      border-radius:8px;
      border:1px solid #d1d5db;
      padding:8px 10px;
      width:100%;
      box-sizing:border-box;
    }
    textarea{
      min-height:80px;
      resize:vertical;
    }
    input:focus, select:focus, textarea:focus{
      outline:none;
      border-color:var(--accent);
      box-shadow:0 0 0 1px rgba(42,98,82,.25);
    }

    /* CHANGE B: slightly more vertical space under every question */
    .row{
      margin-bottom:24px; /* was 16px */
    }

    .hint{
      font-size:12px;
      color:var(--muted);
      margin-top:4px;
    }

    .nav{
      margin-top:24px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:8px;
    }

    .btn{
      background:var(--accent);
      color:#fff;
      border:none;
      border-radius:8px;
      padding:8px 16px;
      font-size:14px;
      cursor:pointer;
    }
    .btn[disabled]{opacity:.5; cursor:default;}
    .btn.outline{
      background:transparent;
      color:#111827;
      border:1px solid #d1d5db;
    }

    .note{
      font-size:13px;
      color:var(--muted);
      margin-top:4px;
    }
    .error{
      font-size:12px;
      color:#b91c1c;
      margin-top:3px;
      display:none;
    }
    .error.show{display:block;}

    .options{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
    }
    .options label.inline{
      display:inline-flex;
      align-items:center;
      gap:4px;
      font-size:13px;
      border-radius:999px;
      padding:4px 10px;
      background:#f3f4f6;
    }
    .options label.inline input{
      width:auto;
    }
    .other-wrap{
      display:flex;
      flex-direction:column;
      gap:4px;
      margin-top:6px;
    }

    .chip-list{
      display:flex;
      flex-wrap:wrap;
      gap:6px;
      margin-top:6px;
    }
    .chip{
      font-size:12px;
      border-radius:999px;
      padding:4px 10px;
      background:#f3f4f6;
      cursor:pointer;
    }
    .chip.selected{
      background:#111827;
      color:#fff;
    }

    .success{
      display:none;
      text-align:center;
      padding:32px 16px;
    }
    .success.active{display:block;}
    .success h2{
      margin:0 0 8px;
      font-size:24px;
    }
    .success p{
      margin:0 0 4px;
      color:var(--muted);
    }

    .loading{
      position:absolute;
      inset:0;
      background:rgba(255,255,255,.7);
      display:flex;
      align-items:center;
      justify-content:center;
      border-radius:16px;
      display:none;
    }
    .loading.show{display:flex;}
    .spinner{
      width:32px;
      height:32px;
      border-radius:999px;
      border:3px solid #e5e7eb;
      border-top-color:var(--accent);
      animation:spin 1s linear infinite;
    }

    .matrix{
      width:100%;
      border-collapse:collapse;
      margin-top:8px;
    }
    .matrix th,
    .matrix td{
      padding:8px 6px;
      border-bottom:1px solid #e5e7eb;
      text-align:left;
      font-size:14px;
    }
    .matrix th{
      font-weight:600;
      color:#374151;
    }
    .matrix input[type="number"]{
      width:100%;
      box-sizing:border-box;
    }

    /* Page 5 + global: keep options in one horizontal line & aligned */
    .matrix .impact-options{
      display:flex;
      gap:12px;
      flex-wrap:wrap;
      font-size:13px;
      align-items:center;
    }

    /* CHANGE A: keep radios small so they don't overlap text */
    .matrix .impact-options label.inline input{
      width:auto;
      margin:0;
    }
    .matrix .impact-options label.inline{
      white-space:nowrap;
    }

    @keyframes spin{to{transform:rotate(360deg)}}

    /* ============================================
       DESKTOP STYLES - Allineamento colonne
       ============================================ */
    @media (min-width: 769px) {
      /* Larghezze fisse per allineamento colonne - SOLO DESKTOP */
      .matrix th:nth-child(2),
      .matrix td:nth-child(2) {
        width: 180px; /* As of today */
        min-width: 180px;
      }
      
      .matrix th:nth-child(3),
      .matrix td:nth-child(3) {
        width: 180px; /* Before INNOVIT */
        min-width: 180px;
      }
      
      .matrix th:nth-child(4),
      .matrix td:nth-child(4) {
        width: 320px; /* INNOVIT impact (radio buttons) */
        min-width: 320px;
      }
    }

    /* ============================================
       MOBILE RESPONSIVE STYLES
       ============================================ */
    @media (max-width: 768px) {
      /* Riduco padding generale del container */
      .container {
        padding: 16px 16px 32px;
      }

      /* Brand header più compatto su mobile */
      .brand-header {
        padding: 12px 16px;
        margin: 0 auto 12px;
      }
      .brand-logo {
        height: 36px;
      }

      /* Titoli più piccoli su mobile */
      h1 {
        font-size: 22px;
        margin: 12px auto 4px;
      }
      .sub {
        font-size: 14px;
        margin: 0 auto 14px;
      }

      /* Card con padding ridotto */
      .card {
        padding: 20px 16px 24px;
      }

      /* Progress bar più sottile */
      .bar {
        height: 8px;
        margin: 10px 0 16px;
      }

      /* Steps indicator più compatto */
      .steps {
        font-size: 11px;
        gap: 6px;
        flex-wrap: wrap;
      }
      .steps .dot {
        width: 20px;
        height: 20px;
        font-size: 11px;
      }
      .steps span.sep {
        display: none; /* Nascondo le linee di separazione su mobile */
      }

      /* Grid a singola colonna su mobile */
      .grid {
        grid-template-columns: 1fr;
        gap: 16px;
      }

      /* Tutti gli input a larghezza piena */
      .step[data-stage="1"] input,
      .step[data-stage="1"] textarea,
      .step[data-stage="1"] select {
        width: 100%;
      }

      /* Riduzioni varie */
      .row {
        margin-bottom: 20px;
      }

      label {
        font-size: 13px;
      }

      input, select, textarea {
        font-size: 16px; /* 16px previene lo zoom automatico su iOS */
        padding: 10px 12px;
      }

      textarea {
        min-height: 100px;
      }

      /* Bottoni impilati verticalmente su mobile */
      .nav {
        flex-direction: column-reverse;
        gap: 10px;
        margin-top: 20px;
      }

      .btn {
        width: 100%;
        padding: 12px 16px;
        font-size: 15px;
      }

      /* ============================================
         LAYOUT MOBILE COMPLETAMENTE RIVOLUZIONATO
         Tabelle → Card Verticali
         ============================================ */
      
      /* Nascondi le intestazioni delle tabelle su mobile */
      .matrix thead {
        display: none;
      }

      /* Trasforma la tabella in layout a blocchi */
      .matrix,
      .matrix tbody,
      .matrix tr,
      .matrix td {
        display: block;
        width: 100%;
      }

      /* Ogni riga della tabella diventa una card */
      .matrix tr {
        background: white;
        border: 2px solid #e5e7eb;
        border-radius: 12px;
        padding: 16px;
        margin-bottom: 20px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      }

      /* Prima cella (label) - stile titolo */
      .matrix td:first-child {
        font-size: 16px;
        font-weight: 700;
        color: #111827;
        margin-bottom: 16px;
        padding: 0 0 12px 0;
        border-bottom: 2px solid #f3f4f6;
      }

      /* Altre celle - aggiungi label prima del campo */
      .matrix td:nth-child(2)::before {
        content: 'As of today';
        display: block;
        font-size: 12px;
        font-weight: 600;
        color: #6b7280;
        margin-bottom: 6px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .matrix td:nth-child(3)::before {
        content: 'Before INNOVIT';
        display: block;
        font-size: 12px;
        font-weight: 600;
        color: #6b7280;
        margin-bottom: 6px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .matrix td:nth-child(4)::before {
        content: 'INNOVIT impact';
        display: block;
        font-size: 12px;
        font-weight: 600;
        color: #6b7280;
        margin-bottom: 8px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      /* Spacing tra i campi */
      .matrix td {
        padding: 0;
        margin-bottom: 16px;
      }

      .matrix td:last-child {
        margin-bottom: 0;
      }

      /* Input e select - dimensioni normali ma full width */
      .matrix input[type="number"],
      .matrix select {
        width: 100% !important;
        min-width: 100% !important;
        font-size: 16px !important; /* 16px per evitare zoom iOS */
        padding: 12px 14px !important;
        border: 1px solid #d1d5db !important;
        border-radius: 8px !important;
        box-sizing: border-box !important;
      }

      .matrix input[type="number"]:focus,
      .matrix select:focus {
        border-color: var(--accent) !important;
        box-shadow: 0 0 0 3px rgba(42,98,82,.15) !important;
        outline: none !important;
      }

      /* Impact options - layout verticale con bottoni grandi */
      .matrix .impact-options {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .matrix .impact-options label.inline {
        display: flex !important;
        align-items: center;
        justify-content: flex-start;
        padding: 12px 14px;
        background: #f9fafb;
        border: 2px solid #e5e7eb;
        border-radius: 8px;
        font-size: 14px !important;
        margin: 0 !important;
        cursor: pointer;
        transition: all 0.2s;
        width: 100%;
        box-sizing: border-box;
      }

      .matrix .impact-options label.inline:has(input:checked) {
        background: var(--accent);
        border-color: var(--accent);
        color: white;
        font-weight: 600;
      }

      .matrix .impact-options input[type="radio"] {
        margin: 0 10px 0 0 !important;
        width: 20px !important;
        height: 20px !important;
        flex-shrink: 0;
      }

      /* Bottoni - larghi come i campi input */
      .nav {
        flex-direction: column-reverse;
        gap: 12px;
        margin-top: 24px;
      }

      .btn {
        width: calc(100% + 32px) !important; /* Compensa padding card (16px) x 2 lati */
        margin-left: -16px !important; /* Esce dal padding sinistro della card */
        margin-right: -16px !important; /* Esce dal padding destro della card */
        padding: 16px 32px !important; /* Padding interno per compensare */
        font-size: 16px !important;
        font-weight: 600 !important;
        border-radius: 0 !important; /* Angoli retti per effetto full-width */
      }

      .btn.outline {
        padding: 14px 32px !important;
        font-size: 15px !important;
      }
      
      /* Wrapper left/right a width piena */
      .nav .left,
      .nav .right {
        width: 100%;
      }
        margin-bottom: 0;
      }

      /* Options e chips più compatti */
      .options {
        gap: 6px;
      }

      .options label.inline {
        font-size: 12px;
        padding: 6px 10px;
      }

      .chip {
        font-size: 11px;
        padding: 6px 10px;
      }

      /* Hint e note più piccoli */
      .hint, .note {
        font-size: 11px;
      }

      .error {
        font-size: 11px;
      }

      /* Success message */
      .success h2 {
        font-size: 20px;
      }

      .success p {
        font-size: 14px;
      }

      /* Loading spinner */
      .spinner {
        width: 28px;
        height: 28px;
      }
    }

    /* Breakpoint per schermi molto piccoli (< 480px) */
    @media (max-width: 480px) {
      .container {
        padding: 12px 12px 24px;
      }

      .brand-header {
        padding: 10px 12px;
      }

      .brand-header h2 {
        font-size: 20px;
      }

      h1 {
        font-size: 20px;
      }

      .card {
        padding: 16px 12px 20px;
        border-radius: 12px;
      }

      /* Card delle metriche leggermente più compatte */
      .matrix tr {
        padding: 14px;
      }

      .matrix td:first-child {
        font-size: 15px;
      }
    }

    /* CHANGE B: stronger, smoother divider between metric questions */
    .step[data-stage="2"] .row,
    .step[data-stage="3"] .row,
    .step[data-stage="4"] .row,
    .step[data-stage="5"] .row,
    .step[data-stage="6"] .row{
      margin-top:32px;               /* +1 line of space above each question */
      padding-top:20px;
      border-top:2px solid #e5e7eb;  /* slightly thicker but still light */
    }
    .step[data-stage="2"] .row:first-of-type,
    .step[data-stage="3"] .row:first-of-type,
    .step[data-stage="4"] .row:first-of-type,
    .step[data-stage="5"] .row:first-of-type,
    .step[data-stage="6"] .row:first-of-type{
      border-top:none;
      padding-top:0;
      margin-top:16px;               /* softer gap under section title */
    }

    /* Highlight invalid fields */
    .invalid{
      border-color:#b91c1c !important;
      box-shadow:0 0 0 1px rgba(185,28,28,.2);
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Brand header with logo -->
    <header class="brand-header">
      <h2 style="margin:0; color:white; font-size:24px; font-weight:700; letter-spacing:0.5px;">INNOVIT SF</h2>
    </header>

    <!-- WhatsApp/In-app Browser Warning Banner -->
    <div id="browserWarning" style="display:none; background:#fff3cd; border:1px solid #ffc107; border-radius:12px; padding:16px; margin:0 auto 16px; max-width:1200px;">
      <div style="display:flex; align-items:center; gap:12px;">
        <div style="font-size:24px;">⚠️</div>
        <div style="flex:1;">
          <strong style="display:block; margin-bottom:4px; color:#856404;">For best experience, open in your browser</strong>
          <p style="margin:0; font-size:13px; color:#856404;">This form works better in Chrome, Safari, or Firefox. Tap the menu (•••) and select "Open in Browser".</p>
        </div>
      </div>
    </div>

    <h1>INNOVIT – Alumni Progress</h1>
    <p class="sub">Please help us understand your progress since participating in an INNOVIT program.</p>

    <div class="card">
      <!-- Progress -->
      <div class="steps" aria-hidden="true">
        <div class="dot active" data-step="1">1</div>
        <span class="label">Company &amp; Program</span>
        <span class="sep"></span>

        <div class="dot" data-step="2">2</div>
        <span class="label">Revenues &amp; Employees</span>
        <span class="sep"></span>

        <div class="dot" data-step="3">3</div>
        <span class="label">Fundraising</span>
        <span class="sep"></span>

        <div class="dot" data-step="4">4</div>
        <span class="label">Clients &amp; POCs</span>
        <span class="sep"></span>

        <div class="dot" data-step="5">5</div>
        <span class="label">US Ecosystem</span>
        <span class="sep"></span>

        <div class="dot" data-step="6">6</div>
        <span class="label">US Network</span>
      </div>
      <div class="bar"><div id="barFill"></div></div>

      <form id="appForm">
        <!-- STEP 1: Company & Program -->
        <section class="step active" data-stage="1">
          <h2>Company &amp; Program Information</h2>

          <div class="grid">
            <div class="row">
              <label>Company Name<span class="req">*</span></label>
              <select name="company_name" required>
                <option value="">Select your company</option>
                <option value="221E">221E</option>
                <option value="ABzero">ABzero</option>
                <option value="Accelerat">Accelerat</option>
                <option value="Ada Travel">Ada Travel</option>
                <option value="Adaptronics">Adaptronics</option>
                <option value="AEnergy Power S.r.l.">AEnergy Power S.r.l.</option>
                <option value="AerariumChain">AerariumChain</option>
                <option value="Agade">Agade</option>
                <option value="AIDRO">AIDRO</option>
                <option value="AIKO">AIKO</option>
                <option value="Aileens Pharma">Aileens Pharma</option>
                <option value="AINDO">AINDO</option>
                <option value="ALBA Robot">ALBA Robot</option>
                <option value="Alexandrite Lighting">Alexandrite Lighting</option>
                <option value="Algo">Algo</option>
                <option value="Alphafood">Alphafood</option>
                <option value="Altea Green Power">Altea Green Power</option>
                <option value="Altilia">Altilia</option>
                <option value="ALTO Robotics">ALTO Robotics</option>
                <option value="AnotheReality">AnotheReality</option>
                <option value="AnteMotion">AnteMotion</option>
                <option value="AorticLab">AorticLab</option>
                <option value="Aptus.AI">Aptus.AI</option>
                <option value="AR Market">AR Market</option>
                <option value="ARCA Dynamics">ARCA Dynamics</option>
                <option value="Aries Tech - Cathedra">Aries Tech - Cathedra</option>
                <option value="Arredo Inox">Arredo Inox</option>
                <option value="ARS Automation">ARS Automation</option>
                <option value="ArtCentrica">ArtCentrica</option>
                <option value="Arxax">Arxax</option>
                <option value="Astrakode">Astrakode</option>
                <option value="Aten">Aten</option>
                <option value="Aton">Aton</option>
                <option value="Auditorium">Auditorium</option>
                <option value="Awentia">Awentia</option>
                <option value="Azzurrodigitale Machine Integration">Azzurrodigitale Machine Integration</option>
                <option value="Babylon Cloud">Babylon Cloud</option>
                <option value="BCC Studio">BCC Studio</option>
                <option value="BdSound">BdSound</option>
                <option value="beexlab srl (aka albicchiere)">beexlab srl (aka albicchiere)</option>
                <option value="BeNewtral">BeNewtral</option>
                <option value="BetterSea Power srl SB">BetterSea Power srl SB</option>
                <option value="Beyondshape srl">Beyondshape srl</option>
                <option value="Binoocle Institute">Binoocle Institute</option>
                <option value="Biocompatibility Innovation">Biocompatibility Innovation</option>
                <option value="BionIT Labs">BionIT Labs</option>
                <option value="Biotitan Nanotechnology">Biotitan Nanotechnology</option>
                <option value="BitBang">BitBang</option>
                <option value="Blacks">Blacks</option>
                <option value="Blaster Foundry">Blaster Foundry</option>
                <option value="Blockchain Italia">Blockchain Italia</option>
                <option value="Blue Gold">Blue Gold</option>
                <option value="Blue Innovation">Blue Innovation</option>
                <option value="BLUMIT">BLUMIT</option>
                <option value="BrainDTech">BrainDTech</option>
                <option value="BRTCONSULTING">BRTCONSULTING</option>
                <option value="Builtdifferent">Builtdifferent</option>
                <option value="Builti">Builti</option>
                <option value="Business Changers">Business Changers</option>
                <option value="BxT">BxT</option>
                <option value="CAELUS">CAELUS</option>
                <option value="Canova Tech">Canova Tech</option>
                <option value="Caprice Bespoke S.r.l.">Caprice Bespoke S.r.l.</option>
                <option value="Capsule Corporation">Capsule Corporation</option>
                <option value="Caracol">Caracol</option>
                <option value="Cardo AI">Cardo AI</option>
                <option value="CellPly">CellPly</option>
                <option value="Cerebro">Cerebro</option>
                <option value="ChemiCare">ChemiCare</option>
                <option value="Cicero.Live">Cicero.Live</option>
                <option value="Clean OS">Clean OS</option>
                <option value="COD Milano srlf">COD Milano srlf</option>
                <option value="Coderblock">Coderblock</option>
                <option value="Coffeefrom">Coffeefrom</option>
                <option value="Cognivix s.r.l.">Cognivix s.r.l.</option>
                <option value="COMFTECH">COMFTECH</option>
                <option value="Confirmo">Confirmo</option>
                <option value="CShark">CShark</option>
                <option value="Cyberangels">Cyberangels</option>
                <option value="Cyberneid">Cyberneid</option>
                <option value="Cynomys">Cynomys</option>
                <option value="daidalos">daidalos</option>
                <option value="DaLunedì">DaLunedì</option>
                <option value="Damo Srl">Damo Srl</option>
                <option value="DataSpark AI">DataSpark AI</option>
                <option value="Debord Technologies">Debord Technologies</option>
                <option value="Deep Blue">Deep Blue</option>
                <option value="Deplotic">Deplotic</option>
                <option value="Develop-Players">Develop-Players</option>
                <option value="DevIBrain">DevIBrain</option>
                <option value="Diamante">Diamante</option>
                <option value="Digital Forest">Digital Forest</option>
                <option value="Digitiamo">Digitiamo</option>
                <option value="Dilium">Dilium</option>
                <option value="D-TAILS S.R.L. SB">D-TAILS S.R.L. SB</option>
                <option value="Dootbox">Dootbox</option>
                <option value="DRB">DRB</option>
                <option value="DRESS UP">DRESS UP</option>
                <option value="Drop Digital Health">Drop Digital Health</option>
                <option value="DSQM">DSQM</option>
                <option value="E4 Computer Engineering">E4 Computer Engineering</option>
                <option value="Ecosmic">Ecosmic</option>
                <option value="Edge SDN">Edge SDN</option>
                <option value="Elephant Brain Lab srl">Elephant Brain Lab srl</option>
                <option value="èlevit">èlevit</option>
                <option value="Eligo">Eligo</option>
                <option value="Emaze Gaming">Emaze Gaming</option>
                <option value="Emerals">Emerals</option>
                <option value="Enapter">Enapter</option>
                <option value="Enerpaper">Enerpaper</option>
                <option value="enGenome">enGenome</option>
                <option value="Engreen">Engreen</option>
                <option value="ENVIRO srl">ENVIRO srl</option>
                <option value="Eoliann">Eoliann</option>
                <option value="ERA OPHTHALMICA">ERA OPHTHALMICA</option>
                <option value="Ernesto">Ernesto</option>
                <option value="Esprit de Vie">Esprit de Vie</option>
                <option value="Eudata">Eudata</option>
                <option value="EvaluationTool">EvaluationTool</option>
                <option value="EXE - Engineering for Environment">EXE - Engineering for Environment</option>
                <option value="EYE-TECH SRL">EYE-TECH SRL</option>
                <option value="EZ LAB">EZ LAB</option>
                <option value="FAIRTILE">FAIRTILE</option>
                <option value="Farzati">Farzati</option>
                <option value="Fashion For Biodiversity SRL">Fashion For Biodiversity SRL</option>
                <option value="Federmanager Academy Delegation">Federmanager Academy Delegation</option>
                <option value="Filippo Trotta">Filippo Trotta</option>
                <option value="Finanz">Finanz</option>
                <option value="flowtech">flowtech</option>
                <option value="Fluentis">Fluentis</option>
                <option value="Future Value">Future Value</option>
                <option value="Futurenext">Futurenext</option>
                <option value="Galdi">Galdi</option>
                <option value="Game2Value">Game2Value</option>
                <option value="Ganiga Innovation">Ganiga Innovation</option>
                <option value="GardenStuff">GardenStuff</option>
                <option value="GEK">GEK</option>
                <option value="Gemelli Digital Medicine & Health srl">Gemelli Digital Medicine &amp; Health srl</option>
                <option value="Genius Loci srl (The thinking clouds)">Genius Loci srl (The thinking clouds)</option>
                <option value="GenLife Italia srl">GenLife Italia srl</option>
                <option value="Genogra">Genogra</option>
                <option value="Getra">Getra</option>
                <option value="Glam You Up SRL">Glam You Up SRL</option>
                <option value="Glutensens Srl">Glutensens Srl</option>
                <option value="GoVisit">GoVisit</option>
                <option value="Green Future Project">Green Future Project</option>
                <option value="Green Independence">Green Independence</option>
                <option value="GRID+">GRID+</option>
                <option value="Haruspex">Haruspex</option>
                <option value="Healthyfood (MyCIA)">Healthyfood (MyCIA)</option>
                <option value="Hercle">Hercle</option>
                <option value="HEROBOTS">HEROBOTS</option>
                <option value="Hexagro">Hexagro</option>
                <option value="HexErgy s.r.l.">HexErgy s.r.l.</option>
                <option value="Hiop">Hiop</option>
                <option value="Hodlie">Hodlie</option>
                <option value="HuKnow">HuKnow</option>
                <option value="Huna">Huna</option>
                <option value="Hyntelo">Hyntelo</option>
                <option value="Hypermeteo">Hypermeteo</option>
                <option value="I.D.T. SRL SOCIETA' BENEFIT">I.D.T. SRL SOCIETA' BENEFIT</option>
                <option value="i²d">i²d</option>
                <option value="Icarus">Icarus</option>
                <option value="ICOP">ICOP</option>
                <option value="Igrox">Igrox</option>
                <option value="iHeel">iHeel</option>
                <option value="IllumyFi">IllumyFi</option>
                <option value="IMMERXIVE">IMMERXIVE</option>
                <option value="INOVA LAB S.R.L.">INOVA LAB S.R.L.</option>
                <option value="InSililicoTrials Technologies">InSililicoTrials Technologies</option>
                <option value="InSimili">InSimili</option>
                <option value="INTA">INTA</option>
                <option value="Intella">Intella</option>
                <option value="Interactive Media">Interactive Media</option>
                <option value="Into The Blue">Into The Blue</option>
                <option value="Intuos">Intuos</option>
                <option value="Invenium Legaltech">Invenium Legaltech</option>
                <option value="Involve Space">Involve Space</option>
                <option value="IPLABS">IPLABS</option>
                <option value="Iride Acque">Iride Acque</option>
                <option value="IRIF (Remote)">IRIF (Remote)</option>
                <option value="IrWise">IrWise</option>
                <option value="Is CLEAN AIR">Is CLEAN AIR</option>
                <option value="ISUAL">ISUAL</option>
                <option value="It's Prodigy">It's Prodigy</option>
                <option value="Italian Lifestyle srl">Italian Lifestyle srl</option>
                <option value="j4energy">j4energy</option>
                <option value="J4ENERGY (J4 Srl)">J4ENERGY (J4 Srl)</option>
                <option value="Karaoke One">Karaoke One</option>
                <option value="Klara">Klara</option>
                <option value="Knitronix">Knitronix</option>
                <option value="Komete">Komete</option>
                <option value="Krateo">Krateo</option>
                <option value="Kulto">Kulto</option>
                <option value="Kytabu">Kytabu</option>
                <option value="Las Mobili">Las Mobili</option>
                <option value="Latitudo 40">Latitudo 40</option>
                <option value="LAUNCHERSCANNER">LAUNCHERSCANNER</option>
                <option value="Lemons in the room">Lemons in the room</option>
                <option value="Library Med">Library Med</option>
                <option value="Life Meter">Life Meter</option>
                <option value="LifeCharger srl">LifeCharger srl</option>
                <option value="Limbico (Genoma)">Limbico (Genoma)</option>
                <option value="Limenet">Limenet</option>
                <option value="Linari Engineering">Linari Engineering</option>
                <option value="Linari Medical">Linari Medical</option>
                <option value="Link.it">Link.it</option>
                <option value="LMA">LMA</option>
                <option value="LUXEVIEW">LUXEVIEW</option>
                <option value="MAC&NIL">MAC&amp;NIL</option>
                <option value="Maind Capital">Maind Capital</option>
                <option value="Malvestio">Malvestio</option>
                <option value="Manta Group">Manta Group</option>
                <option value="Markeplay">Markeplay</option>
                <option value="MARTINOROSSI">MARTINOROSSI</option>
                <option value="Math Biology">Math Biology</option>
                <option value="Maxi Mobility">Maxi Mobility</option>
                <option value="Meddle">Meddle</option>
                <option value="Mediate">Mediate</option>
                <option value="Mediavoice">Mediavoice</option>
                <option value="Medics">Medics</option>
                <option value="medicud">medicud</option>
                <option value="Medlea">Medlea</option>
                <option value="Mela Works">Mela Works</option>
                <option value="Melazeta">Melazeta</option>
                <option value="Memento">Memento</option>
                <option value="Monokee">Monokee</option>
                <option value="More Than Access">More Than Access</option>
                <option value="Mountain Maps">Mountain Maps</option>
                <option value="Move-X">Move-X</option>
                <option value="Moveo">Moveo</option>
                <option value="Must Had">Must Had</option>
                <option value="Myndoor">Myndoor</option>
                <option value="Nano-Tech">Nano-Tech</option>
                <option value="Nanomnia">Nanomnia</option>
                <option value="Natural You srl">Natural You srl</option>
                <option value="Neocad">Neocad</option>
                <option value="Nest.City">Nest.City</option>
                <option value="NeuroSyntek">NeuroSyntek</option>
                <option value="Next Generation Robotics">Next Generation Robotics</option>
                <option value="NextAV">NextAV</option>
                <option value="NEXTFLAG SRL">NEXTFLAG SRL</option>
                <option value="Nextome">Nextome</option>
                <option value="Nextsense">Nextsense</option>
                <option value="NH2 Tech Srl">NH2 Tech Srl</option>
                <option value="NIDO Unmanned Box System">NIDO Unmanned Box System</option>
                <option value="Notarify">Notarify</option>
                <option value="NOVAEKA">NOVAEKA</option>
                <option value="NOVAICOS ImmunoTherapeutics s.r.l.">NOVAICOS ImmunoTherapeutics s.r.l.</option>
                <option value="Nutras srl">Nutras srl</option>
                <option value="OASI SOCIETA' BENEFIT SRL">OASI SOCIETA' BENEFIT SRL</option>
                <option value="OLIMPOFLEX">OLIMPOFLEX</option>
                <option value="Olivia">Olivia</option>
                <option value="Omnienergy">Omnienergy</option>
                <option value="Onetcall srl">Onetcall srl</option>
                <option value="OpenMall">OpenMall</option>
                <option value="Oraigo">Oraigo</option>
                <option value="ORiS">ORiS</option>
                <option value="Osense">Osense</option>
                <option value="Oversonic Robotics">Oversonic Robotics</option>
                <option value="Particular Materials">Particular Materials</option>
                <option value="Partitalia">Partitalia</option>
                <option value="Pausetiv Srl">Pausetiv Srl</option>
                <option value="Pinpoint">Pinpoint</option>
                <option value="Plannest">Plannest</option>
                <option value="PlantBit">PlantBit</option>
                <option value="Plantvoice">Plantvoice</option>
                <option value="PlayNook">PlayNook</option>
                <option value="Podium Engineering">Podium Engineering</option>
                <option value="Pradella Sistemi">Pradella Sistemi</option>
                <option value="Pragma Etimos">Pragma Etimos</option>
                <option value="Prensilia srl">Prensilia srl</option>
                <option value="Prometeo">Prometeo</option>
                <option value="PROSUME">PROSUME</option>
                <option value="Proteso">Proteso</option>
                <option value="prysm (Customix)">prysm (Customix)</option>
                <option value="Purilian">Purilian</option>
                <option value="Qi4M">Qi4M</option>
                <option value="Quido.ai">Quido.ai</option>
                <option value="Quindi">Quindi</option>
                <option value="QX s.r.l">QX s.r.l</option>
                <option value="Radicalbit">Radicalbit</option>
                <option value="RAIN">RAIN</option>
                <option value="React4life">React4life</option>
                <option value="Real Bowl">Real Bowl</option>
                <option value="Realspa srl">Realspa srl</option>
                <option value="Reasoned Art">Reasoned Art</option>
                <option value="RecapGPT">RecapGPT</option>
                <option value="Renovo">Renovo</option>
                <option value="ResilientX Italia">ResilientX Italia</option>
                <option value="Resmart">Resmart</option>
                <option value="Restaurants Club">Restaurants Club</option>
                <option value="Revivo S.r.l. Società Benefit">Revivo S.r.l. Società Benefit</option>
                <option value="Revolv Space">Revolv Space</option>
                <option value="RF MICROTECH">RF MICROTECH</option>
                <option value="RIC3D">RIC3D</option>
                <option value="Ride2share S.R.L. (Wegoo)">Ride2share S.R.L. (Wegoo)</option>
                <option value="Robosan">Robosan</option>
                <option value="Rocchi Technologies">Rocchi Technologies</option>
                <option value="Rubyno.Studio">Rubyno.Studio</option>
                <option value="SaferPlaces">SaferPlaces</option>
                <option value="SailADV">SailADV</option>
                <option value="Salute 360">Salute 360</option>
                <option value="SANTINI">SANTINI</option>
                <option value="SBAM SOCIAL SRL">SBAM SOCIAL SRL</option>
                <option value="Scen">Scen</option>
                <option value="SCUTER">SCUTER</option>
                <option value="Searcode">Searcode</option>
                <option value="Servimed Industrial">Servimed Industrial</option>
                <option value="Shopthelook">Shopthelook</option>
                <option value="Sidereus Space Dynamics">Sidereus Space Dynamics</option>
                <option value="SIEVE SRL">SIEVE SRL</option>
                <option value="Sigma Ingegneria">Sigma Ingegneria</option>
                <option value="SlimNet Srl">SlimNet Srl</option>
                <option value="SLY">SLY</option>
                <option value="Small Pixels">Small Pixels</option>
                <option value="Social Thingum">Social Thingum</option>
                <option value="Sòphia High Tech">Sòphia High Tech</option>
                <option value="soulShape S.R.L.s. S.B.">soulShape S.R.L.s. S.B.</option>
                <option value="Space 11">Space 11</option>
                <option value="Space Frontier">Space Frontier</option>
                <option value="Space Products and Innovation (SPiN)">Space Products and Innovation (SPiN)</option>
                <option value="Spacearth Technology">Spacearth Technology</option>
                <option value="Spaice Technology">Spaice Technology</option>
                <option value="Spaider">Spaider</option>
                <option value="Spherecube">Spherecube</option>
                <option value="Spoki">Spoki</option>
                <option value="Stakeshare">Stakeshare</option>
                <option value="Startacrowd">Startacrowd</option>
                <option value="SunCubes">SunCubes</option>
                <option value="TA-DAAN">TA-DAAN</option>
                <option value="Techinnova">Techinnova</option>
                <option value="Techinnova S.p.A.">Techinnova S.p.A.</option>
                <option value="Tekrevolution">Tekrevolution</option>
                <option value="Tender">Tender</option>
                <option value="Tepy">Tepy</option>
                <option value="TerraViva">TerraViva</option>
                <option value="TEST 1 SRL SB (T1 Solutions)">TEST 1 SRL SB (T1 Solutions)</option>
                <option value="Teticum.com">Teticum.com</option>
                <option value="The Edge Company">The Edge Company</option>
                <option value="The Glass Élite">The Glass Élite</option>
                <option value="The Italian pharmacy cosmetics">The Italian pharmacy cosmetics</option>
                <option value="The PAAC">The PAAC</option>
                <option value="Ticketoo">Ticketoo</option>
                <option value="Titan4">Titan4</option>
                <option value="Tiwi">Tiwi</option>
                <option value="TOD System S.R.L.">TOD System S.R.L.</option>
                <option value="Tomato+">Tomato+</option>
                <option value="Trackting">Trackting</option>
                <option value="TradePulse">TradePulse</option>
                <option value="Traent">Traent</option>
                <option value="Trainect">Trainect</option>
                <option value="Traveleco">Traveleco</option>
                <option value="TRIBYOU - YOUR PLACES">TRIBYOU - YOUR PLACES</option>
                <option value="Trigit">Trigit</option>
                <option value="Truesense">Truesense</option>
                <option value="TUC.technology">TUC.technology</option>
                <option value="Tutored - Joiners">Tutored - Joiners</option>
                <option value="TUTTOTONDO">TUTTOTONDO</option>
                <option value="Twini">Twini</option>
                <option value="Untold Games">Untold Games</option>
                <option value="Urbana Smart Solutions S.r.l.">Urbana Smart Solutions S.r.l.</option>
                <option value="Vector Robotics Srl">Vector Robotics Srl</option>
                <option value="Versy">Versy</option>
                <option value="Viber Alert">Viber Alert</option>
                <option value="Viceversa">Viceversa</option>
                <option value="Virevo (DeKali)">Virevo (DeKali)</option>
                <option value="VisioNing">VisioNing</option>
                <option value="Visual Note">Visual Note</option>
                <option value="Volta Structural Energy">Volta Structural Energy</option>
                <option value="Volumio">Volumio</option>
                <option value="Wallfarm">Wallfarm</option>
                <option value="WAVENURE">WAVENURE</option>
                <option value="Wearable Robotics">Wearable Robotics</option>
                <option value="Wearevolution">Wearevolution</option>
                <option value="Wesii">Wesii</option>
                <option value="Western CO">Western CO</option>
                <option value="While True srl">While True srl</option>
                <option value="WholeTech">WholeTech</option>
                <option value="Wsense">Wsense</option>
                <option value="XRIT">XRIT</option>
                <option value="Yookye">Yookye</option>
                <option value="zanbiotech">zanbiotech</option>
                <option value="Zephorum">Zephorum</option>
                <option value="Zerow">Zerow</option>
                <option value="Zirak s.r.l.">Zirak s.r.l.</option>
              </select>
              <div class="error" data-for="company_name">This field is required.</div>
            </div>

            <div class="row">
              <label>INNOVIT Program<span class="req">*</span></label>
              <select name="innovit_program" required>
                <option value="">Select your program</option>
                <!-- Cohorts ordinati dal primo (2023) all'ultimo (2025) con distinzione 1 week / 2 weeks -->
                
                <!-- 2023 Programs -->
                <option>(2023) Cohort 1 - 1 week - AI, Metaverso, Industrie Creative - Marzo 2023 (SMEs Traction)</option>
                <option>(2023) Cohort 1 - 2 weeks - AI, Metaverso, Industrie Creative - Marzo 2023 (Startup Acceleration)</option>
                
                <option>(2023) Cohort 2 - 1 week - Cybersecurity, Blockchain, IoT, Robotics - Giugno-Luglio 2023 (SMEs Traction)</option>
                <option>(2023) Cohort 2 - 2 weeks - Cybersecurity, Blockchain, IoT, Robotics - Giugno-Luglio 2023 (Startup Bootcamp)</option>
                
                <option>(2023) Cohort 3 - 1 week - Climate &amp; Green Energy, FoodTech - Settembre 2023 (SMEs Traction)</option>
                <option>(2023) Cohort 3 - 2 weeks - Climate &amp; Green Energy, FoodTech - Settembre 2023 (Startup Acceleration)</option>
                
                <option>(2023) Cohort 4 - 1 week - Space Economy - Nov-Dic 2023 (SMEs Traction)</option>
                
                <!-- 2024 Programs -->
                <option>(2024) Cohort 5 - 1 week - Generative AI - Feb-Mar 2024 (SMEs Traction)</option>
                <option>(2024) Cohort 5 - 2 weeks - Generative AI - Feb-Mar 2024 (Startup Acceleration)</option>
                
                <option>(2024) Cohort 6 - 1 week - Robotics, Hardware, Advanced Materials - Apr-Mag 2024 (SMEs Traction)</option>
                <option>(2024) Cohort 6 - 2 weeks - Robotics, Hardware, Advanced Materials - Apr-Mag 2024 (Startup Acceleration)</option>
                
                <option>(2024) Cohort 7 - 1 week - Life Sciences &amp; Digital Health - Giu-Lug 2024 (SMEs Traction)</option>
                <option>(2024) Cohort 7 - 2 weeks - Life Sciences &amp; Digital Health - Giu-Lug 2024 (Startup Acceleration)</option>
                
                <option>(2024) Cohort 8 - 1 week - Green Energy, CleanTech, AgriFoodTech - Set 2024 (SMEs Traction)</option>
                
                <option>(2024) Cohort 9 - 1 week - Fintech &amp; Insurtech - Ott 2024 (SMEs Traction)</option>
                <option>(2024) Cohort 9 - 2 weeks - Fintech &amp; Insurtech - Ott 2024 (Startup Bootcamp)</option>
                
                <option>(2024) Cohort 10 - 1 week - Space Economy - Nov-Dic 2024 (SMEs Traction)</option>
                
                <!-- 2025 Programs -->
                <option>(2025) Cohort 11 - 1 week - AI Game Dev/AR-VR-MR/Metaverse - Mar 2025 (SMEs Traction)</option>
                <option>(2025) Cohort 11 - 2 weeks - AI Game Dev/AR-VR-MR/Metaverse - Mar 2025 (Startup Bootcamp)</option>
                
                <option>(2025) Cohort 12 - 1 week - Space Economy - Mag 2025 (SMEs Traction)</option>
                
                <option>(2025) Cohort 13 - 1 week - Life Sciences / BioTech / Longevity - Giu 2025 (SMEs Traction)</option>
                <option>(2025) Cohort 13 - 2 weeks - Life Sciences / BioTech / Longevity - Giu 2025 (Startup Acceleration)</option>
                
                <option>(2025) Cohort 14 - 1 week - FashionTech / BeautyTech - Lug-Ago 2025 (SMEs Traction)</option>
                <option>(2025) Cohort 14 - 2 weeks - FashionTech / BeautyTech - Lug-Ago 2025 (Startup Acceleration)</option>
                
                <option>(2025) Cohort 15 - 1 week - Hardware / Robotics / IOT / Smart Manufacturing - Ott-Nov 2025 (SMEs Traction)</option>
                <option>(2025) Cohort 15 - 2 weeks - Hardware / Robotics / IOT / Smart Manufacturing - Ott-Nov 2025 (Startup Acceleration)</option>
                
                <option>(2025) Cohort 16 - 1 week - CleanTech / AgriFoodTech / Blue Economy - Dic 2025 (SMEs Traction)</option>
                
                <option>Other / Not listed INNOVIT program</option>
              </select>
              <div class="error" data-for="innovit_program">Please select the program.</div>
            </div>
          </div>

          <div class="grid">
            <div class="row">
              <label>Company maturity at entry to INNOVIT<span class="req">*</span></label>
              <select name="maturity_at_entry" required>
                <option value="">Select one</option>
                <option>Idea / Concept</option>
                <option>Prototype / MVP</option>
                <option>Pilot(s) with first customers</option>
                <option>Launched product with early revenues</option>
                <option>Scaling company</option>
              </select>
              <div class="error" data-for="maturity_at_entry">Please select one option.</div>
            </div>

            <div class="row">
              <label>Funding stage at entry to INNOVIT<span class="req">*</span></label>
              <select name="funding_stage_entry" required>
                <option value="">Select one</option>
                <option>Pre-seed</option>
                <option>Seed</option>
                <option>Series A</option>
                <option>Series B+</option>
                <option>Bootstrapped</option>
                <option>SME / Established company</option>
              </select>
              <div class="error" data-for="funding_stage_entry">Please select one option.</div>
            </div>
          </div>

          <div class="grid-1">
            <div class="row">
              <label>Primary business model<span class="req">*</span></label>
              <div class="options" data-name="business_model">
                <label class="inline"><input type="radio" name="business_model" value="B2B"> B2B</label>
                <label class="inline"><input type="radio" name="business_model" value="B2C"> B2C</label>
                <label class="inline"><input type="radio" name="business_model" value="B2B2C"> B2B2C</label>
                <label class="inline"><input type="radio" name="business_model" value="Other"> Other</label>
              </div>
              <input type="text" name="business_model_other" placeholder="If Other, please specify">
              <div class="error" data-for="business_model">Please select your primary business model.</div>
            </div>
          </div>

          <div class="grid">
            <div class="row">
              <label>Total Annual Revenue (current)<span class="req">*</span></label>
              <input type="number" name="current_total_revenue" min="0" required placeholder="e.g. 1500000">
              <p class="hint">All markets combined, in your reporting currency</p>
              <div class="error" data-for="current_total_revenue">This field is required.</div>
            </div>

            <div class="row">
              <label>Total Funding Raised (cumulative)<span class="req">*</span></label>
              <input type="number" name="current_total_funding" min="0" required placeholder="e.g. 500000">
              <p class="hint">All investors, all rounds combined</p>
              <div class="error" data-for="current_total_funding">This field is required.</div>
            </div>
          </div>

          <div class="grid-1">
            <div class="row">
              <label>Total Employees (current)<span class="req">*</span></label>
              <input type="number" name="current_total_employees" min="0" required placeholder="e.g. 25">
              <p class="hint">Total number of employees, globally</p>
              <div class="error" data-for="current_total_employees">This field is required.</div>
            </div>
          </div>

          <div class="nav">
            <div class="left"></div>
            <div class="right">
              <button type="button" class="btn" id="to-2">Next</button>
            </div>
          </div>
        </section>

        <!-- STEP 2: Revenues & Employees -->
        <section class="step" data-stage="2">
          <h2>Revenues &amp; Employees</h2>

          <!-- GLOBAL REVENUE -->
          <div class="row">
            <label>
              Global annual revenue (all markets combined, in your reporting currency)<span class="req">*</span>
            </label>
            <table class="matrix" aria-label="Global revenue before and after INNOVIT">
              <thead>
                <tr>
                  <th></th>
                  <!-- GLOBAL REQUIREMENT: As of today first -->
                  <th>As of today</th>
                  <th>Before INNOVIT</th>
                  <th>INNOVIT impact</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>Global revenue</strong></td>
                  <td>
                    <input type="number" name="q2_global_revenue_today" min="0" required placeholder="e.g. 1500000">
                  </td>
                  <td>
                    <input type="number" name="q2_global_revenue_before" min="0" required placeholder="e.g. 1000000">
                  </td>
                  <td>
                    <div class="impact-options">
                      <label class="inline"><input type="radio" name="q2_global_revenue_impact" value="None"> None</label>
                      <label class="inline"><input type="radio" name="q2_global_revenue_impact" value="Slightly"> Slightly</label>
                      <label class="inline"><input type="radio" name="q2_global_revenue_impact" value="Quite"> Quite</label>
                      <label class="inline"><input type="radio" name="q2_global_revenue_impact" value="Very relevant"> Very relevant</label>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
            <p class="hint">If exact numbers are not available, please use your best estimate.</p>
          </div>

          <!-- US REVENUE -->
          <div class="row">
            <label>
              Annual revenue from the US market (only US-based customers, same currency)<span class="req">*</span>
            </label>
            <table class="matrix" aria-label="US revenue before and after INNOVIT">
              <thead>
                <tr>
                  <th></th>
                  <th>As of today</th>
                  <th>Before INNOVIT</th>
                  <th>INNOVIT impact</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>US revenue</strong></td>
                  <td>
                    <input type="number" name="q2_us_revenue_today" min="0" required placeholder="e.g. 500000">
                  </td>
                  <td>
                    <input type="number" name="q2_us_revenue_before" min="0" required placeholder="e.g. 200000">
                  </td>
                  <td>
                    <div class="impact-options">
                      <label class="inline"><input type="radio" name="q2_us_revenue_impact" value="None"> None</label>
                      <label class="inline"><input type="radio" name="q2_us_revenue_impact" value="Slightly"> Slightly</label>
                      <label class="inline"><input type="radio" name="q2_us_revenue_impact" value="Quite"> Quite</label>
                      <label class="inline"><input type="radio" name="q2_us_revenue_impact" value="Very relevant"> Very relevant</label>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
            <p class="hint">If exact numbers are not available, please use your best estimate.</p>
          </div>

          <!-- GLOBAL EMPLOYEES -->
          <div class="row">
            <label>
              Number of employees – Global<span class="req">*</span>
            </label>
            <table class="matrix" aria-label="Global employees before and after INNOVIT">
              <thead>
                <tr>
                  <th></th>
                  <th>As of today</th>
                  <th>Before INNOVIT</th>
                  <th>INNOVIT impact</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>Global employees</strong></td>
                  <td>
                    <input type="number" name="q2_global_fte_today" min="0" required placeholder="e.g. 12">
                  </td>
                  <td>
                    <input type="number" name="q2_global_fte_before" min="0" required placeholder="e.g. 5">
                  </td>
                  <td>
                    <div class="impact-options">
                      <label class="inline"><input type="radio" name="q2_global_fte_impact" value="None"> None</label>
                      <label class="inline"><input type="radio" name="q2_global_fte_impact" value="Slightly"> Slightly</label>
                      <label class="inline"><input type="radio" name="q2_global_fte_impact" value="Quite"> Quite</label>
                      <label class="inline"><input type="radio" name="q2_global_fte_impact" value="Very relevant"> Very relevant</label>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
            <p class="hint">If exact numbers are not available, please use your best estimate.</p>
          </div>

          <!-- US EMPLOYEES -->
          <div class="row">
            <label>
              Number of employees – US-based<span class="req">*</span>
            </label>
            <table class="matrix" aria-label="US-based employees before and after INNOVIT">
              <thead>
                <tr>
                  <th></th>
                  <th>As of today</th>
                  <th>Before INNOVIT</th>
                  <th>INNOVIT impact</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>US-based employees</strong></td>
                  <td>
                    <input type="number" name="q2_us_fte_today" min="0" required placeholder="e.g. 3">
                  </td>
                  <td>
                    <input type="number" name="q2_us_fte_before" min="0" required placeholder="e.g. 0">
                  </td>
                  <td>
                    <div class="impact-options">
                      <label class="inline"><input type="radio" name="q2_us_fte_impact" value="None"> None</label>
                      <label class="inline"><input type="radio" name="q2_us_fte_impact" value="Slightly"> Slightly</label>
                      <label class="inline"><input type="radio" name="q2_us_fte_impact" value="Quite"> Quite</label>
                      <label class="inline"><input type="radio" name="q2_us_fte_impact" value="Very relevant"> Very relevant</label>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
            <p class="hint">If exact numbers are not available, please use your best estimate.</p>
          </div>

          <div class="nav">
            <div class="left">
              <button type="button" class="btn outline" id="back-1">Back</button>
            </div>
            <div class="right">
              <button type="button" class="btn" id="to-3">Next</button>
            </div>
          </div>
        </section>

        <!-- STEP 3: Fundraising -->
        <section class="step" data-stage="3">
          <h2>Fundraising</h2>

          <!-- TOTAL CAPITAL RAISED -->
          <div class="row">
            <label>
              Total capital raised (all investors, cumulative)<span class="req">*</span>
            </label>
            <table class="matrix" aria-label="Total capital raised before and after INNOVIT">
              <thead>
                <tr>
                  <th></th>
                  <th>As of today</th>
                  <th>Before INNOVIT</th>
                  <th>INNOVIT impact</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>Total capital raised</strong></td>
                  <td>
                    <input type="number" name="q3_total_capital_today" min="0" required placeholder="e.g. 3000000">
                  </td>
                  <td>
                    <input type="number" name="q3_total_capital_before" min="0" required placeholder="e.g. 500000">
                  </td>
                  <td>
                    <div class="impact-options">
                      <label class="inline"><input type="radio" name="q3_total_capital_impact" value="None"> None</label>
                      <label class="inline"><input type="radio" name="q3_total_capital_impact" value="Slightly"> Slightly</label>
                      <label class="inline"><input type="radio" name="q3_total_capital_impact" value="Quite"> Quite</label>
                      <label class="inline"><input type="radio" name="q3_total_capital_impact" value="Very relevant"> Very relevant</label>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- CAPITAL FROM US INVESTORS -->
          <div class="row">
            <label>
              Capital raised from US-based investors (cumulative)<span class="req">*</span>
            </label>
            <table class="matrix" aria-label="Capital from US investors before and after INNOVIT">
              <thead>
                <tr>
                  <th></th>
                  <th>As of today</th>
                  <th>Before INNOVIT</th>
                  <th>INNOVIT impact</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>US-based investors</strong></td>
                  <td>
                    <input type="number" name="q3_us_capital_today" min="0" required placeholder="e.g. 1500000">
                  </td>
                  <td>
                    <input type="number" name="q3_us_capital_before" min="0" required placeholder="e.g. 0">
                  </td>
                  <td>
                    <div class="impact-options">
                      <label class="inline"><input type="radio" name="q3_us_capital_impact" value="None"> None</label>
                      <label class="inline"><input type="radio" name="q3_us_capital_impact" value="Slightly"> Slightly</label>
                      <label class="inline"><input type="radio" name="q3_us_capital_impact" value="Quite"> Quite</label>
                      <label class="inline"><input type="radio" name="q3_us_capital_impact" value="Very relevant"> Very relevant</label>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="nav">
            <div class="left">
              <button type="button" class="btn outline" id="back-2">Back</button>
            </div>
            <div class="right">
              <button type="button" class="btn" id="to-4">Next</button>
            </div>
          </div>
        </section>

        <!-- STEP 4: Clients & POCs -->
        <section class="step" data-stage="4">
          <h2>Clients &amp; POCs</h2>

          <!-- US PAYING CLIENTS -->
          <div class="row">
            <label>
              Number of active paying clients in the US<span class="req">*</span>
            </label>
            <table class="matrix" aria-label="US paying clients before and after INNOVIT">
              <thead>
                <tr>
                  <th></th>
                  <th>As of today</th>
                  <th>Before INNOVIT</th>
                  <th>INNOVIT impact</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>US paying clients</strong></td>
                  <td>
                    <input type="number" name="q4_us_clients_today" min="0" required placeholder="e.g. 5">
                  </td>
                  <td>
                    <input type="number" name="q4_us_clients_before" min="0" required placeholder="e.g. 0">
                  </td>
                  <td>
                    <div class="impact-options">
                      <label class="inline"><input type="radio" name="q4_us_clients_impact" value="None"> None</label>
                      <label class="inline"><input type="radio" name="q4_us_clients_impact" value="Slightly"> Slightly</label>
                      <label class="inline"><input type="radio" name="q4_us_clients_impact" value="Quite"> Quite</label>
                      <label class="inline"><input type="radio" name="q4_us_clients_impact" value="Very relevant"> Very relevant</label>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- NON-US PAYING CLIENTS -->
          <div class="row">
            <label>
              Number of active paying clients outside the US<span class="req">*</span>
            </label>
            <table class="matrix" aria-label="Non-US paying clients before and after INNOVIT">
              <thead>
                <tr>
                  <th></th>
                  <th>As of today</th>
                  <th>Before INNOVIT</th>
                  <th>INNOVIT impact</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>Non-US paying clients</strong></td>
                  <td>
                    <input type="number" name="q4_non_us_clients_today" min="0" required placeholder="e.g. 10">
                  </td>
                  <td>
                    <input type="number" name="q4_non_us_clients_before" min="0" required placeholder="e.g. 3">
                  </td>
                  <td>
                    <div class="impact-options">
                      <label class="inline"><input type="radio" name="q4_non_us_clients_impact" value="None"> None</label>
                      <label class="inline"><input type="radio" name="q4_non_us_clients_impact" value="Slightly"> Slightly</label>
                      <label class="inline"><input type="radio" name="q4_non_us_clients_impact" value="Quite"> Quite</label>
                      <label class="inline"><input type="radio" name="q4_non_us_clients_impact" value="Very relevant"> Very relevant</label>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- US POCs -->
          <div class="row">
            <label>
              Number of POCs (Proofs of Concept) with US-based clients/partners (cumulative)<span class="req">*</span>
            </label>
            <table class="matrix" aria-label="US POCs before and after INNOVIT">
              <thead>
                <tr>
                  <th></th>
                  <th>As of today</th>
                  <th>Before INNOVIT</th>
                  <th>INNOVIT impact</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>US POCs</strong></td>
                  <td>
                    <input type="number" name="q4_us_pocs_today" min="0" required placeholder="e.g. 4">
                  </td>
                  <td>
                    <input type="number" name="q4_us_pocs_before" min="0" required placeholder="e.g. 0">
                  </td>
                  <td>
                    <div class="impact-options">
                      <label class="inline"><input type="radio" name="q4_us_pocs_impact" value="None"> None</label>
                      <label class="inline"><input type="radio" name="q4_us_pocs_impact" value="Slightly"> Slightly</label>
                      <label class="inline"><input type="radio" name="q4_us_pocs_impact" value="Quite"> Quite</label>
                      <label class="inline"><input type="radio" name="q4_us_pocs_impact" value="Very relevant"> Very relevant</label>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- NON-US POCs -->
          <div class="row">
            <label>
              Number of POCs with non-US clients/partners (cumulative)<span class="req">*</span>
            </label>
            <table class="matrix" aria-label="Non-US POCs before and after INNOVIT">
              <thead>
                <tr>
                  <th></th>
                  <th>As of today</th>
                  <th>Before INNOVIT</th>
                  <th>INNOVIT impact</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>Non-US POCs</strong></td>
                  <td>
                    <input type="number" name="q4_non_us_pocs_today" min="0" required placeholder="e.g. 6">
                  </td>
                  <td>
                    <input type="number" name="q4_non_us_pocs_before" min="0" required placeholder="e.g. 1">
                  </td>
                  <td>
                    <div class="impact-options">
                      <label class="inline"><input type="radio" name="q4_non_us_pocs_impact" value="None"> None</label>
                      <label class="inline"><input type="radio" name="q4_non_us_pocs_impact" value="Slightly"> Slightly</label>
                      <label class="inline"><input type="radio" name="q4_non_us_pocs_impact" value="Quite"> Quite</label>
                      <label class="inline"><input type="radio" name="q4_non_us_pocs_impact" value="Very relevant"> Very relevant</label>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="nav">
            <div class="left">
              <button type="button" class="btn outline" id="back-3">Back</button>
            </div>
            <div class="right">
              <button type="button" class="btn" id="to-5">Next</button>
            </div>
          </div>
        </section>

        <!-- STEP 5: US Incorporation & Ecosystem -->
        <section class="step" data-stage="5">
          <h2>US Incorporation &amp; Ecosystem</h2>

          <!-- US LEGAL ENTITY -->
          <div class="row">
            <label>
              Does your company have a US legal entity (incorporated in the US)?<span class="req">*</span>
            </label>
            <table class="matrix" aria-label="US legal entity before and after INNOVIT">
              <thead>
                <tr>
                  <th></th>
                  <th>As of today</th>
                  <th>Before INNOVIT</th>
                  <th>INNOVIT impact</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>US legal entity</strong></td>
                  <td>
                    <select name="q5_us_entity_today" required>
                      <option value="">Select</option>
                      <option>Yes</option>
                      <option>No</option>
                    </select>
                  </td>
                  <td>
                    <select name="q5_us_entity_before" required>
                      <option value="">Select</option>
                      <option>Yes</option>
                      <option>No</option>
                    </select>
                  </td>
                  <td>
                    <div class="impact-options">
                      <label class="inline"><input type="radio" name="q5_us_entity_impact" value="None"> None</label>
                      <label class="inline"><input type="radio" name="q5_us_entity_impact" value="Slightly"> Slightly</label>
                      <label class="inline"><input type="radio" name="q5_us_entity_impact" value="Quite"> Quite</label>
                      <label class="inline"><input type="radio" name="q5_us_entity_impact" value="Very relevant"> Very relevant</label>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- US ADVISORS / MENTORS / BOARD -->
          <div class="row">
            <label>
              US-based advisors / mentors / board members (number of active relationships)<span class="req">*</span>
            </label>
            <table class="matrix" aria-label="US advisors before and after INNOVIT">
              <thead>
                <tr>
                  <th></th>
                  <th>As of today</th>
                  <th>Before INNOVIT</th>
                  <th>INNOVIT impact</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>US advisors / mentors / board</strong></td>
                  <td>
                    <input type="number" name="q5_us_advisors_today" min="0" required placeholder="e.g. 3">
                  </td>
                  <td>
                    <input type="number" name="q5_us_advisors_before" min="0" required placeholder="e.g. 0">
                  </td>
                  <td>
                    <div class="impact-options">
                      <label class="inline"><input type="radio" name="q5_us_advisors_impact" value="None"> None</label>
                      <label class="inline"><input type="radio" name="q5_us_advisors_impact" value="Slightly"> Slightly</label>
                      <label class="inline"><input type="radio" name="q5_us_advisors_impact" value="Quite"> Quite</label>
                      <label class="inline"><input type="radio" name="q5_us_advisors_impact" value="Very relevant"> Very relevant</label>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- US COMMERCIAL / STRATEGIC PARTNERS -->
          <div class="row">
            <label>
              US-based commercial / strategic partners (number of active relationships)<span class="req">*</span>
            </label>
            <table class="matrix" aria-label="US partners before and after INNOVIT">
              <thead>
                <tr>
                  <th></th>
                  <th>As of today</th>
                  <th>Before INNOVIT</th>
                  <th>INNOVIT impact</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>US commercial / strategic partners</strong></td>
                  <td>
                    <input type="number" name="q5_us_partners_today" min="0" required placeholder="e.g. 2">
                  </td>
                  <td>
                    <input type="number" name="q5_us_partners_before" min="0" required placeholder="e.g. 0">
                  </td>
                  <td>
                    <div class="impact-options">
                      <label class="inline"><input type="radio" name="q5_us_partners_impact" value="None"> None</label>
                      <label class="inline"><input type="radio" name="q5_us_partners_impact" value="Slightly"> Slightly</label>
                      <label class="inline"><input type="radio" name="q5_us_partners_impact" value="Quite"> Quite</label>
                      <label class="inline"><input type="radio" name="q5_us_partners_impact" value="Very relevant"> Very relevant</label>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- US SERVICE PROVIDERS -->
          <div class="row">
            <label>
              US-based consultants / service providers (e.g. legal, tax, GTM)<span class="req">*</span>
            </label>
            <table class="matrix" aria-label="US service providers before and after INNOVIT">
              <thead>
                <tr>
                  <th></th>
                  <th>As of today</th>
                  <th>Before INNOVIT</th>
                  <th>INNOVIT impact</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>US consultants / service providers</strong></td>
                  <td>
                    <input type="number" name="q5_us_services_today" min="0" required placeholder="e.g. 4">
                  </td>
                  <td>
                    <input type="number" name="q5_us_services_before" min="0" required placeholder="e.g. 0">
                  </td>
                  <td>
                    <div class="impact-options">
                      <label class="inline"><input type="radio" name="q5_us_services_impact" value="None"> None</label>
                      <label class="inline"><input type="radio" name="q5_us_services_impact" value="Slightly"> Slightly</label>
                      <label class="inline"><input type="radio" name="q5_us_services_impact" value="Quite"> Quite</label>
                      <label class="inline"><input type="radio" name="q5_us_services_impact" value="Very relevant"> Very relevant</label>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="nav">
            <div class="left">
              <button type="button" class="btn outline" id="back-4">Back</button>
            </div>
            <div class="right">
              <button type="button" class="btn" id="to-6">Next</button>
            </div>
          </div>
        </section>

        <!-- STEP 6: Perceived US Network Strength -->
        <section class="step" data-stage="6">
          <h2>Perceived US Network Strength</h2>

          <div class="row">
            <label>
              How strong was your US network of contacts?<span class="req">*</span>
            </label>
            <table class="matrix" aria-label="Perceived US network strength before and after INNOVIT">
              <thead>
                <tr>
                  <th></th>
                  <th>As of today</th>
                  <th>Before INNOVIT</th>
                  <th>INNOVIT impact</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>Perceived US network strength</strong></td>
                  <td>
                    <select name="q6_network_today" required>
                      <option value="">Select</option>
                      <option>Very weak</option>
                      <option>Rather weak</option>
                      <option>Rather strong</option>
                      <option>Very strong</option>
                    </select>
                  </td>
                  <td>
                    <select name="q6_network_before" required>
                      <option value="">Select</option>
                      <option>Very weak</option>
                      <option>Rather weak</option>
                      <option>Rather strong</option>
                      <option>Very strong</option>
                    </select>
                  </td>
                  <td>
                    <div class="impact-options">
                      <label class="inline"><input type="radio" name="q6_network_impact" value="None"> None</label>
                      <label class="inline"><input type="radio" name="q6_network_impact" value="Slightly"> Slightly</label>
                      <label class="inline"><input type="radio" name="q6_network_impact" value="Quite"> Quite</label>
                      <label class="inline"><input type="radio" name="q6_network_impact" value="Very relevant"> Very relevant</label>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
            <p class="hint">Think about your ability to access relevant people, information, and opportunities in the US.</p>
          </div>

          <div class="nav">
            <div class="left">
              <button type="button" class="btn outline" id="back-5">Back</button>
            </div>
            <div class="right">
              <button type="button" class="btn" id="submit-final">Submit</button>
            </div>
          </div>
        </section>
      </form>

      <!-- Final thank you text updated per requirements -->
      <div class="success" id="success">
        <h2>Thank you from INNOVIT</h2>
        <p>We truly appreciate the time you invested in sharing your progress with us.</p>
        <p>Your answers help us strengthen INNOVIT programs and better support our alumni community.</p>
        <p>Grazie di cuore,<br>The INNOVIT team</p>
      </div>

      <div class="loading" id="loading">
        <div class="spinner"></div>
      </div>
    </div>
  </div>

  <script>
    // CONFIG: Google Apps Script endpoint (unchanged)
    const WEBAPP_URL = 'https://script.google.com/macros/s/AKfycbwqt2hbEoXwlwa-CWYHRUFSJoQJBeo14ypuRT29OpTGSSyGaWiuEdPLCI7PbTeAvbgA0A/exec';
    const SECRET = 'optional-static-token';
    
    // DEMO MODE: Set to true to test form without backend connection
    // Set to false for production use with Google Apps Script
    const DEMO_MODE = false;

    // Browser compatibility check for WhatsApp and other in-app browsers
    (function checkCompatibility() {
      const issues = [];
      
      // Check if running in WhatsApp or similar in-app browser
      const ua = navigator.userAgent || '';
      const isInAppBrowser = /FBAN|FBAV|Instagram|WhatsApp|Line|WeChat/i.test(ua);
      
      if (isInAppBrowser) {
        console.log('📱 Detected in-app browser, showing warning banner');
        const banner = document.getElementById('browserWarning');
        if (banner) {
          banner.style.display = 'block';
        }
      }
      
      // Test essential features
      if (typeof fetch === 'undefined') {
        issues.push('Fetch API not supported');
      }
      if (typeof FormData === 'undefined') {
        issues.push('FormData not supported');
      }
      
      if (issues.length > 0) {
        console.warn('⚠️ Browser compatibility issues:', issues);
      }
    })();

    // Helpers
    const $ = (sel, root=document) => root.querySelector(sel);
    const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));

    // Generate session ID with fallback for WhatsApp in-app browser
    let sessionId;
    try {
      if (typeof crypto !== 'undefined' && crypto.randomUUID) {
        sessionId = crypto.randomUUID();
      } else {
        sessionId = Date.now() + '-' + Math.random().toString(36).slice(2) + Math.random().toString(36).slice(2);
      }
    } catch (e) {
      sessionId = Date.now() + '-' + Math.random().toString(36).slice(2) + Math.random().toString(36).slice(2);
    }

    const TOTAL_STEPS = 6;

    function setProgress(step){
      const dots = $$('.steps .dot');
      dots.forEach(d => d.classList.toggle('active', Number(d.dataset.step) <= step));
      const pct = (step - 1) / (TOTAL_STEPS - 1) * 100;
      $('#barFill').style.width = pct + '%';
    }

    function activeStage(){
      const sec = $('.step.active');
      return sec ? Number(sec.dataset.stage) : 1;
    }

    function showLoading(flag){
      $('#loading').classList.toggle('show', !!flag);
    }

    // Validation helpers
    function clearErrors(scope){
      if (!scope) return;
      $$('.error', scope).forEach(e => e.classList.remove('show'));
      $$('input,select,textarea', scope).forEach(el => el.classList.remove('invalid'));
    }

    function markInvalid(el){
      if (!el) return;
      el.classList.add('invalid');
    }

    function showError(name, msg){
      const el = $(`.error[data-for="${name}"]`);
      if (el){
        if (msg) el.textContent = msg;
        el.classList.add('show');
      }
    }

    function isUrl(str){
      try{
        const u = new URL(str);
        return !!u.protocol && !!u.host;
      } catch(e){
        return false;
      }
    }

    // Matrix config: PRE / TODAY / IMPACT triads per stage
    const MATRIX_CONFIG = {
      2: [
        { before:'q2_global_revenue_before', today:'q2_global_revenue_today', impact:'q2_global_revenue_impact' },
        { before:'q2_us_revenue_before',     today:'q2_us_revenue_today',     impact:'q2_us_revenue_impact' },
        { before:'q2_global_fte_before',     today:'q2_global_fte_today',     impact:'q2_global_fte_impact' },
        { before:'q2_us_fte_before',         today:'q2_us_fte_today',         impact:'q2_us_fte_impact' }
      ],
      3: [
        { before:'q3_total_capital_before',  today:'q3_total_capital_today',  impact:'q3_total_capital_impact' },
        { before:'q3_us_capital_before',     today:'q3_us_capital_today',     impact:'q3_us_capital_impact' }
      ],
      4: [
        { before:'q4_us_clients_before',     today:'q4_us_clients_today',     impact:'q4_us_clients_impact' },
        { before:'q4_non_us_clients_before', today:'q4_non_us_clients_today', impact:'q4_non_us_clients_impact' },
        { before:'q4_us_pocs_before',        today:'q4_us_pocs_today',        impact:'q4_us_pocs_impact' },
        { before:'q4_non_us_pocs_before',    today:'q4_non_us_pocs_today',    impact:'q4_non_us_pocs_impact' }
      ],
      5: [
        { before:'q5_us_entity_before',      today:'q5_us_entity_today',      impact:'q5_us_entity_impact', type:'select' },
        { before:'q5_us_advisors_before',    today:'q5_us_advisors_today',    impact:'q5_us_advisors_impact' },
        { before:'q5_us_partners_before',    today:'q5_us_partners_today',    impact:'q5_us_partners_impact' },
        { before:'q5_us_services_before',    today:'q5_us_services_today',    impact:'q5_us_services_impact' }
      ]
    };

    function validateStage(stageNum){
      const sec = document.querySelector(`.step[data-stage="${stageNum}"]`);
      clearErrors(sec);

      // STEP 1: company & program
      if (stageNum === 1){
        let ok = true;

        const companyName = sec.querySelector('select[name="company_name"]');
        const program     = sec.querySelector('select[name="innovit_program"]');
        const maturity    = sec.querySelector('select[name="maturity_at_entry"]');
        const funding     = sec.querySelector('select[name="funding_stage_entry"]');
        const bmRadios    = $$('input[name="business_model"]', sec);
        const bmOther     = sec.querySelector('input[name="business_model_other"]');

        if (!companyName.value.trim()){
          showError('company_name','This field is required.');
          markInvalid(companyName);
          ok = false;
        }

        if (!program.value){
          showError('innovit_program','Please select the program.');
          markInvalid(program);
          ok = false;
        }

        if (!maturity.value){
          showError('maturity_at_entry','Please select one option.');
          markInvalid(maturity);
          ok = false;
        }

        if (!funding.value){
          showError('funding_stage_entry','Please select one option.');
          markInvalid(funding);
          ok = false;
        }

        const bmSelected = bmRadios.find(r => r.checked);
        if (!bmSelected){
          showError('business_model','Please select your primary business model.');
          bmRadios.forEach(r => markInvalid(r));
          ok = false;
        } else if (bmSelected.value === 'Other'){
          if (!bmOther.value.trim()){
            showError('business_model','Please specify your business model.');
            markInvalid(bmOther);
            ok = false;
          }
        }

        return ok;
      }

      // STEPS 2–5: numeric/select matrices with PRE / TODAY / IMPACT
      if (MATRIX_CONFIG[stageNum]){
        let ok = true;
        const questions = MATRIX_CONFIG[stageNum];

        questions.forEach(q => {
          const beforeEl  = sec.querySelector(`[name="${q.before}"]`);
          const todayEl   = sec.querySelector(`[name="${q.today}"]`);
          const impactEls = $$(`input[name="${q.impact}"]`, sec);

          if (beforeEl && !String(beforeEl.value).trim()){
            markInvalid(beforeEl);
            ok = false;
          }
          if (todayEl && !String(todayEl.value).trim()){
            markInvalid(todayEl);
            ok = false;
          }
          if (impactEls.length && !impactEls.some(r => r.checked)){
            // highlight first radio in the group
            markInvalid(impactEls[0]);
            ok = false;
          }
        });

        if (!ok){
          alert('Please complete all fields in this section before continuing.');
        }
        return ok;
      }

      // STEP 6: perceived US network strength
      if (stageNum === 6){
        let ok = true;

        const beforeSel    = sec.querySelector('select[name="q6_network_before"]');
        const todaySel     = sec.querySelector('select[name="q6_network_today"]');
        const impactRadios = $$('input[name="q6_network_impact"]', sec);

        if (!beforeSel.value){
          markInvalid(beforeSel);
          ok = false;
        }
        if (!todaySel.value){
          markInvalid(todaySel);
          ok = false;
        }
        if (!impactRadios.some(r => r.checked)){
          markInvalid(impactRadios[0]);
          ok = false;
        }

        if (!ok){
          alert('Please complete all fields in this section before submitting.');
        }
        return ok;
      }

      return true;
    }

    // Collect all fields into a flat object
    function collectFields(){
      const inputs = $$('input, select, textarea');
      const out = {};
      const groups = {};

      inputs.forEach(el => {
        if (!el.name) return;
        if (el.type === 'checkbox') {
          groups[el.name] = groups[el.name] || [];
          if (el.checked) groups[el.name].push(el.value);
        } else if (el.type === 'radio') {
          if (el.checked) out[el.name] = el.value;
          if (!Object.prototype.hasOwnProperty.call(out, el.name)) {
            out[el.name] = out[el.name] || '';
          }
        } else {
          out[el.name] = el.value ?? '';
        }
      });

      Object.entries(groups).forEach(([k,v]) => out[k] = v.join(', '));
      return out;
    }

    async function saveProgress(isFinal){
      const payload = {
        session_id: sessionId,
        stage: String(activeStage()),
        is_final: !!isFinal,
        fields: collectFields(),
        token: SECRET || undefined
      };

      // DEMO MODE: Skip backend call for testing
      if (DEMO_MODE) {
        console.log('[DEMO MODE] Would send to backend:', payload);
        await new Promise(resolve => setTimeout(resolve, 500)); // Simulate network delay
        return 'demo-success';
      }

      const fd = new FormData();
      fd.append('payload', JSON.stringify(payload));

      try {
        const res = await fetch(WEBAPP_URL, {
          method: 'POST',
          body: fd
        });
        const text = await res.text();
        console.log('Response from Apps Script:', text);
        return text;
      } catch (error) {
        console.error('Save error:', error);
        // Continue anyway to not block the form
        console.log('Continuing despite error (data logged in console)');
        return 'error-but-continue';
      }
    }

    // Navigation helpers
    function goToStage(nextStage){
      $('.step.active')?.classList.remove('active');
      $(`.step[data-stage="${nextStage}"]`)?.classList.add('active');
      setProgress(nextStage);
    }

    // Navigation: NEXT
    $('#to-2')?.addEventListener('click', async ()=>{
      if (!validateStage(1)) return;
      showLoading(true);
      try{
        await saveProgress(false);
        goToStage(2);
      } catch(e){
        console.error(e);
        alert('There was an error saving your progress. Please try again.');
      } finally{
        showLoading(false);
      }
    });

    $('#to-3')?.addEventListener('click', async ()=>{
      if (!validateStage(2)) return;
      showLoading(true);
      try{
        await saveProgress(false);
        goToStage(3);
      } catch(e){
        console.error(e);
        alert('There was an error saving your progress. Please try again.');
      } finally{
        showLoading(false);
      }
    });

    $('#to-4')?.addEventListener('click', async ()=>{
      if (!validateStage(3)) return;
      showLoading(true);
      try{
        await saveProgress(false);
        goToStage(4);
      } catch(e){
        console.error(e);
        alert('There was an error saving your progress. Please try again.');
      } finally{
        showLoading(false);
      }
    });

    $('#to-5')?.addEventListener('click', async ()=>{
      if (!validateStage(4)) return;
      showLoading(true);
      try{
        await saveProgress(false);
        goToStage(5);
      } catch(e){
        console.error(e);
        alert('There was an error saving your progress. Please try again.');
      } finally{
        showLoading(false);
      }
    });

    $('#to-6')?.addEventListener('click', async ()=>{
      if (!validateStage(5)) return;
      showLoading(true);
      try{
        await saveProgress(false);
        goToStage(6);
      } catch(e){
        console.error(e);
        alert('There was an error saving your progress. Please try again.');
      } finally{
        showLoading(false);
      }
    });

    // Navigation: BACK
    $('#back-1')?.addEventListener('click', ()=>{ goToStage(1); });
    $('#back-2')?.addEventListener('click', ()=>{ goToStage(2); });
    $('#back-3')?.addEventListener('click', ()=>{ goToStage(3); });
    $('#back-4')?.addEventListener('click', ()=>{ goToStage(4); });
    $('#back-5')?.addEventListener('click', ()=>{ goToStage(5); });

    // Final submit
    $('#submit-final')?.addEventListener('click', async ()=>{
      if (!validateStage(6)) return;
      showLoading(true);
      try{
        await saveProgress(true);
        // Hide form and show thank-you message
        $('#appForm')?.classList.add('hidden');
        $('#appForm')?.setAttribute('style','display:none;');
        $('#success').classList.add('active');
        setProgress(TOTAL_STEPS);
      } catch(e){
        console.error(e);
        alert('There was an error submitting your responses. Please try again.');
      } finally{
        showLoading(false);
      }
    });

    /* CHANGE C: strict numeric-only behaviour on ALL number fields (all pages) */
    $$('#appForm input[type="number"]').forEach(input => {
      input.setAttribute('inputmode','numeric');

      // Clean any non-digit characters on input (also strips "e"/"E" etc).
      input.addEventListener('input', () => {
        input.value = input.value.replace(/[^\d]/g, '');
      });

      // Block non-digit keypresses while allowing control keys.
      input.addEventListener('keypress', (e) => {
        if (e.key.length === 1 && !/[0-9]/.test(e.key)) {
          e.preventDefault();
        }
      });

      // Sanitize pasted content to keep only digits.
      input.addEventListener('paste', (e) => {
        e.preventDefault();
        const text = (e.clipboardData || window.clipboardData)?.getData('text') || '';
        const digits = text.replace(/[^\d]/g, '');
        if (!digits) return;
        const start = input.selectionStart ?? input.value.length;
        const end   = input.selectionEnd ?? input.value.length;
        input.value = input.value.slice(0, start) + digits + input.value.slice(end);
      });
    });

    // Init progress bar
    setProgress(1);
  </script>
</body>
</html>
